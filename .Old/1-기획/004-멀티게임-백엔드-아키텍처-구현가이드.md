---
title: Multi-Game Backend Architecture Implementation Guide
status: active
created: 2025-06-18
project: Gaming Analytics Platform
updated: 2025-06-18
tech_stack: Go + templ + HTMX
architecture: service-oriented-monolith
---
# ë©€í‹°ê²Œì„ ë°±ì—”ë“œ ì•„í‚¤í…ì²˜ êµ¬í˜„ ê°€ì´ë“œ

## ğŸ¯ í˜„ì¬ ë°œë¡œë€íŠ¸ ì„œë¹„ìŠ¤ë¥¼ í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°ë¡œ ë¦¬íŒ©í† ë§

### 1ë‹¨ê³„: í˜„ì¬ êµ¬ì¡° ë¶„ì„
```
í˜„ì¬ êµ¬ì¡° (Phase 1):
valorant-ai-platform/
â”œâ”€â”€ cmd/server/main.go
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ handlers/     # HTTP í•¸ë“¤ëŸ¬
â”‚   â”œâ”€â”€ models/       # ë°ì´í„° ëª¨ë¸
â”‚   â””â”€â”€ services/     # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
```

### 2ë‹¨ê³„: í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°ë¡œ ë³€ê²½
```
ìƒˆë¡œìš´ êµ¬ì¡°:
gaming-analytics-platform/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/main.go
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ domain/          # ê³µí†µ ë„ë©”ì¸ ëª¨ë¸
â”‚   â”‚   â””â”€â”€ services/        # ê³µí†µ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ games/
â”‚   â”‚   â”œâ”€â”€ valorant/        # ë°œë¡œë€íŠ¸ ì „ìš©
â”‚   â”‚   â””â”€â”€ common/          # ê²Œì„ ê³µí†µ ìœ í‹¸
â”‚   â”œâ”€â”€ shared/
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ logger/
â”‚   â””â”€â”€ infrastructure/
â”‚       â”œâ”€â”€ http/            # HTTP í•¸ë“¤ëŸ¬
â”‚       â”œâ”€â”€ database/        # DB ì—°ê²°
â”‚       â””â”€â”€ ai/              # AI í´ë¼ì´ì–¸íŠ¸
```

## ğŸ”„ ë‹¨ê³„ë³„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš

### Step 1: ê³µí†µ ë„ë©”ì¸ ëª¨ë¸ ì •ì˜
```go
// internal/core/domain/player.go
type Player struct {
    ID          string    `json:"id"`
    GameType    GameType  `json:"game_type"`
    ExternalID  string    `json:"external_id"`
    DisplayName string    `json:"display_name"`
    CreatedAt   time.Time `json:"created_at"`
}

type GameType string
const (
    GameTypeValorant GameType = "valorant"
    GameTypeLoL      GameType = "lol"
    GameTypeCS2      GameType = "cs2"
)
```

### Step 2: ê²Œì„ ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
```go
// internal/core/ports/game_service.go
type GameService interface {
    GetPlayer(ctx context.Context, identifier string) (*domain.Player, error)
    GetPlayerStats(ctx context.Context, playerID string) (*domain.PlayerStats, error)
    GetMatches(ctx context.Context, playerID string, limit int) ([]domain.Match, error)
}
```

### Step 3: ë°œë¡œë€íŠ¸ ì„œë¹„ìŠ¤ êµ¬í˜„
```go
// internal/games/valorant/service.go
type ValorantService struct {
    client  *RiotClient
    cache   cache.Client
    logger  logger.Logger
}

func (s *ValorantService) GetPlayer(ctx context.Context, identifier string) (*domain.Player, error) {
    // ë°œë¡œë€íŠ¸ íŠ¹í™” í”Œë ˆì´ì–´ ì¡°íšŒ ë¡œì§
    riotPlayer, err := s.client.GetPlayerByRiotID(ctx, identifier)
    if err != nil {
        return nil, err
    }
    
    return s.transformToCommonPlayer(riotPlayer), nil
}
```

### Step 4: HTTP ë¼ìš°í„° êµ¬ì¡° ë³€ê²½
```go
// internal/infrastructure/http/router.go
func SetupRouter(gameRegistry *GameRegistry) *chi.Mux {
    r := chi.NewRouter()
    
    // ê³µí†µ ë¯¸ë“¤ì›¨ì–´
    r.Use(middleware.RequestID)
    r.Use(middleware.Logger)
    r.Use(middleware.CORS)
    
    // ê²Œì„ë³„ ë¼ìš°íŠ¸
    r.Route("/api/v1/{game}", func(r chi.Router) {
        r.Use(middleware.GameValidator(gameRegistry))
        
        r.Get("/players/{playerID}/stats", gameHandler.GetPlayerStats)
        r.Get("/players/{playerID}/matches", gameHandler.GetPlayerMatches)
        r.Get("/players/{playerID}/insights", gameHandler.GetPlayerInsights)
    })
    
    return r
}
```

## ğŸ® ìƒˆë¡œìš´ ê²Œì„ ì¶”ê°€ í”„ë¡œì„¸ìŠ¤

### 1. ê²Œì„ë³„ ë””ë ‰í„°ë¦¬ ìƒì„±
```
internal/games/lol/
â”œâ”€â”€ client/
â”‚   â”œâ”€â”€ riot_client.go       # LoL API í´ë¼ì´ì–¸íŠ¸
â”‚   â””â”€â”€ models.go            # LoL API ì‘ë‹µ ëª¨ë¸
â”œâ”€â”€ service.go               # GameService ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
â”œâ”€â”€ transformer.go           # LoL â†’ ê³µí†µ ëª¨ë¸ ë³€í™˜
â””â”€â”€ config.go               # LoL íŠ¹í™” ì„¤ì •
```

### 2. ê²Œì„ ì„œë¹„ìŠ¤ êµ¬í˜„
```go
// internal/games/lol/service.go
type LoLService struct {
    client *RiotClient
    cache  cache.Client
}

func (s *LoLService) GetPlayer(ctx context.Context, identifier string) (*domain.Player, error) {
    // LoL íŠ¹í™” ë¡œì§ êµ¬í˜„
}

// ê²Œì„ ë“±ë¡ (main.goì—ì„œ)
func main() {
    gameRegistry := NewGameRegistry()
    
    // ë°œë¡œë€íŠ¸ ì„œë¹„ìŠ¤ ë“±ë¡
    valorantService := valorant.NewService(config.Valorant, db, cache)
    gameRegistry.Register(domain.GameTypeValorant, valorantService)
    
    // LoL ì„œë¹„ìŠ¤ ë“±ë¡
    lolService := lol.NewService(config.LoL, db, cache)
    gameRegistry.Register(domain.GameTypeLoL, lolService)
}
```

### 3. ì„¤ì • êµ¬ì¡° í™•ì¥
```go
// internal/shared/config/config.go
type Config struct {
    Server   ServerConfig   `yaml:"server"`
    Database DatabaseConfig `yaml:"database"`
    Games    GamesConfig    `yaml:"games"`
    AI       AIConfig       `yaml:"ai"`
}

type GamesConfig struct {
    Valorant ValorantConfig `yaml:"valorant"`
    LoL      LoLConfig      `yaml:"lol"`
    CS2      CS2Config      `yaml:"cs2"`
}
```

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ

### ê¸°ì¡´ ë°œë¡œë€íŠ¸ í…Œì´ë¸”ì„ ë²”ìš©ìœ¼ë¡œ ë³€ê²½
```sql
-- 1. ìƒˆë¡œìš´ ë²”ìš© í…Œì´ë¸” ìƒì„±
CREATE TABLE players (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    game_type VARCHAR(20) NOT NULL,
    external_id VARCHAR(100) NOT NULL,
    display_name VARCHAR(100),
    raw_data JSONB,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(game_type, external_id)
);

-- 2. ê¸°ì¡´ ë°œë¡œë€íŠ¸ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
INSERT INTO players (game_type, external_id, display_name, raw_data)
SELECT 'valorant', riot_id, display_name, row_to_json(valorant_players.*)
FROM valorant_players;

-- 3. ê²Œì„ë³„ ì¸ë±ìŠ¤ ìƒì„±
CREATE INDEX idx_players_game_type ON players(game_type);
CREATE INDEX idx_players_external_id ON players(game_type, external_id);
```

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë©”íŠ¸ë¦­

### ê²Œì„ë³„ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
```go
// internal/shared/metrics/metrics.go
type Metrics struct {
    APICallsTotal     *prometheus.CounterVec
    ResponseTime      *prometheus.HistogramVec
    ErrorRate         *prometheus.CounterVec
    CacheHitRate      *prometheus.CounterVec
}

func (m *Metrics) RecordAPICall(game, endpoint string, duration time.Duration) {
    m.APICallsTotal.WithLabelValues(game, endpoint).Inc()
    m.ResponseTime.WithLabelValues(game, endpoint).Observe(duration.Seconds())
}
```

### ê²Œì„ë³„ ëŒ€ì‹œë³´ë“œ êµ¬ì„±
- ë°œë¡œë€íŠ¸: API í˜¸ì¶œ ìˆ˜, ì‘ë‹µ ì‹œê°„, ì—ëŸ¬ìœ¨
- LoL: API í˜¸ì¶œ ìˆ˜, ì‘ë‹µ ì‹œê°„, ì—ëŸ¬ìœ¨
- ê³µí†µ: ì „ì²´ ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­, ìºì‹œ íˆíŠ¸ìœ¨

## ğŸš€ ë°°í¬ ë° ìš´ì˜ ì „ëµ

### Docker ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œ
```dockerfile
# Dockerfile
FROM golang:1.21-alpine AS builder
WORKDIR /app
COPY . .
RUN go mod download
RUN go build -o gaming-platform cmd/server/main.go

FROM alpine:latest
RUN apk --no-cache add ca-certificates
WORKDIR /root/
COPY --from=builder /app/gaming-platform .
COPY --from=builder /app/configs ./configs
CMD ["./gaming-platform"]
```

### í™˜ê²½ë³„ ì„¤ì • ê´€ë¦¬
```yaml
# configs/production.yaml
server:
  port: 8080
  host: "0.0.0.0"

games:
  valorant:
    api_key: ${RIOT_API_KEY}
    rate_limit: 100
    cache_ttl: 300
  lol:
    api_key: ${RIOT_API_KEY}
    rate_limit: 100
    cache_ttl: 300

ai:
  openai:
    api_key: ${OPENAI_API_KEY}
  claude:
    api_key: ${CLAUDE_API_KEY}
```

## ğŸ”„ ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ íƒ€ì„ë¼ì¸

### Week 1-2: êµ¬ì¡° ì¤€ë¹„
- [ ] ìƒˆë¡œìš´ ë””ë ‰í„°ë¦¬ êµ¬ì¡° ìƒì„±
- [ ] ê³µí†µ ë„ë©”ì¸ ëª¨ë¸ ì •ì˜
- [ ] ê²Œì„ ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„

### Week 3-4: ë°œë¡œë€íŠ¸ ì„œë¹„ìŠ¤ ë¦¬íŒ©í† ë§
- [ ] ê¸°ì¡´ ë°œë¡œë€íŠ¸ ì½”ë“œë¥¼ ìƒˆ êµ¬ì¡°ë¡œ ì´ë™
- [ ] GameService ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½

### Week 5-6: ê³µí†µ ì¸í”„ë¼ êµ¬ì¶•
- [ ] ê²Œì„ ë ˆì§€ìŠ¤íŠ¸ë¦¬ êµ¬í˜„
- [ ] ê³µí†µ ë¯¸ë“¤ì›¨ì–´ ì ìš©
- [ ] ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•

### Week 7-8: ìƒˆ ê²Œì„ ì¶”ê°€ (LoL)
- [ ] LoL ì„œë¹„ìŠ¤ êµ¬í˜„
- [ ] API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
- [ ] í†µí•© í…ŒìŠ¤íŠ¸ ìˆ˜í–‰

ì´ êµ¬ì¡°ë¥¼ í†µí•´ ìƒˆë¡œìš´ ê²Œì„ì„ ì¶”ê°€í•  ë•Œë§ˆë‹¤:
1. `internal/games/{game_name}/` ë””ë ‰í„°ë¦¬ ìƒì„±
2. GameService ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
3. ê²Œì„ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë“±ë¡
4. ì„¤ì • íŒŒì¼ì— ê²Œì„ë³„ ì„¤ì • ì¶”ê°€

ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. ê¸°ì¡´ ì¸í”„ë¼ì™€ API êµ¬ì¡°ëŠ” ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
